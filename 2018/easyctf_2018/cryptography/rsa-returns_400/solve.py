#! /usr/bin/env python3
##
# Created for EasyCTF 2018_RSA Returns
# By Amos (LFlare) Ng <amosng1@gmail.com>
##
# Imports
import gmpy2
import binascii

# Variables
n = 8729581225262922855975327965201482091621603739716646047811615593091116970536029316597901441665882719811658068143200342813247447157083464709878924070575467
e = 65537
c = 878655928853960761773919225661790486068412878806617795173227115247948633536895449991072672638729309487928612810206592572097421152539895597550936111603907

# From NECA
p = 98156620780003086692513114529458599425385116396074158691207247964958060681783
q = 88935225722861812850195157838313383408060631426601900565225384215559424240749

# Calculate d
phi = (p-1) * (q-1)
d = gmpy2.invert(e, phi)

# Calculate message
m = int(pow(c, d, n))
print("m: %d" % m)

# Print our message
message = binascii.unhexlify(mHex).decode("utf-8")
print(message)
